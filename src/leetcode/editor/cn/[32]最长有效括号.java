//ç»™ä½ ä¸€ä¸ªåªåŒ…å« '(' å’Œ ')' çš„å­—ç¬¦ä¸²ï¼Œæ‰¾å‡ºæœ€é•¿æœ‰æ•ˆï¼ˆæ ¼å¼æ­£ç¡®ä¸”è¿ç»­ï¼‰æ‹¬å·å­ä¸²çš„é•¿åº¦ã€‚ 
//
// 
//
// 
// 
// ç¤ºä¾‹ 1ï¼š 
//
// 
//è¾“å…¥ï¼šs = "(()"
//è¾“å‡ºï¼š2
//è§£é‡Šï¼šæœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²æ˜¯ "()"
// 
//
// ç¤ºä¾‹ 2ï¼š 
//
// 
//è¾“å…¥ï¼šs = ")()())"
//è¾“å‡ºï¼š4
//è§£é‡Šï¼šæœ€é•¿æœ‰æ•ˆæ‹¬å·å­ä¸²æ˜¯ "()()"
// 
//
// ç¤ºä¾‹ 3ï¼š 
//
// 
//è¾“å…¥ï¼šs = ""
//è¾“å‡ºï¼š0
// 
//
// 
//
// æç¤ºï¼š 
//
// 
// 0 <= s.length <= 3 * 10â´ 
// s[i] ä¸º '(' æˆ– ')' 
// 
// 
// 
// Related Topics æ ˆ å­—ç¬¦ä¸² åŠ¨æ€è§„åˆ’ ğŸ‘ 1783 ğŸ‘ 0


import java.util.Stack;

//leetcode submit region begin(Prohibit modification and deletion)
class Solution32 {
    /**
     * è´ªå¿ƒæ€è·¯, ç©ºé—´å¤æ‚åº¦ O(1)
     * è¯¥æ€è·¯å‚è€ƒ 22, 921, 1541
     *
     * å¯¹äºä¸€ç»„åˆæ³•çš„æ‹¬å·, éå†è¿‡ç¨‹ä¸­ä¸€å®šæ˜¯ left >= right;
     * è´ªå¿ƒçš„æƒ³, å¦‚æœå®ƒä¸€ç›´æ˜¯ left >= right,
     * å®ƒç°åœ¨å¯èƒ½ä¸åˆæ³• ()((), ä½†å®ƒæœªæ¥å¯èƒ½åˆæ³•, ä¹Ÿå¯èƒ½åˆæ³• ((()), åˆæ³•é•¿åº¦ä¸º 2*right
     *
     * ä½†å¦‚æœæ˜¯ left = right, å®ƒç›®å‰ä¸€å®šåˆæ³•, åˆæ³•é•¿åº¦ä¸º 2*right
     * ä¸€æ—¦ left < right, é‚£ä¹ˆå®ƒçš„åˆæ³•æ€§å°±ä¸­æ–­äº†, éœ€è¦é‡æ–°è®¡æ•°
     *
     * ä¸»è¦æ˜¯ left > right æ—¶, æ— æ³•åˆ¤æ–­æ˜¯å¦çœŸçš„åˆæ³•, ä¸è®¡ç®—å®ƒçš„é•¿åº¦å¯èƒ½ä¼šæ¼æ‰åˆæ³•çš„
     * è§£å†³åŠæ³•å°±æ˜¯åå‘å†è®¡ç®—ä¸€é
     */
    public int longestValidParentheses_v3(String s) {
        int left = 0, right = 0;
        int ret = 0;
        for (int i = 0; i < s.length(); i++) {
            if (s.charAt(i) == '(') {
                left++;
            } else {
                right++;
                if (left == right) {
                    ret = Math.max(ret, 2*right);
                } else if (left < right) {
                    left = 0;
                    right = 0;
                }
            }
        }

        left = 0; right = 0;
        for (int i = s.length() - 1; i >= 0; i--) {
            if (s.charAt(i) == ')') {
                left++;
            } else {
                right++;
                if (left == right) {
                    ret = Math.max(ret, 2*right);
                } else if (left < right) {
                    left = 0;
                    right = 0;
                }
            }
        }
        return ret;
    }

    /**
     * æ—¶é—´å¤æ‚åº¦ä¸º O(n), ç©ºé—´å¤æ‚åº¦ä¸º O(n) çš„è§£æ³•
     * çº¯æ ˆè§£æ³•ï¼Œç•™å­˜
     * ç©ºé—´å¤æ‚åº¦ O(1) çš„è§£æ³•ç¨å¾®å‚è€ƒ 22, 921, 1541
     *
     * è¾…åŠ©æ ˆè§£æ³•
     * å§‹ç»ˆä¿æŒæ ˆåº•å…ƒç´ ä¸ºå½“å‰å·²ç»éå†è¿‡çš„å…ƒç´ ä¸­ã€Œæœ€åä¸€ä¸ªæ²¡æœ‰è¢«åŒ¹é…çš„å³æ‹¬å·çš„ä¸‹æ ‡ã€
     *
     * å¯¹äºé‡åˆ°çš„æ¯ä¸ª ( ï¼Œæˆ‘ä»¬å°†å®ƒçš„ä¸‹æ ‡æ”¾å…¥æ ˆä¸­
     * å¯¹äºé‡åˆ°çš„æ¯ä¸ª ) ï¼Œæˆ‘ä»¬å…ˆå¼¹å‡ºæ ˆé¡¶å…ƒç´ è¡¨ç¤ºåŒ¹é…äº†å½“å‰å³æ‹¬å·ï¼š
     *     å¦‚æœæ ˆä¸ºç©ºï¼Œè¯´æ˜å½“å‰çš„å³æ‹¬å·ä¸ºæ²¡æœ‰è¢«åŒ¹é…çš„å³æ‹¬å·ï¼Œæˆ‘ä»¬å°†å…¶ä¸‹æ ‡æ”¾å…¥æ ˆä¸­æ¥æ›´æ–°æˆ‘ä»¬ä¹‹å‰æåˆ°çš„ã€Œæœ€åä¸€ä¸ªæ²¡æœ‰è¢«åŒ¹é…çš„å³æ‹¬å·çš„ä¸‹æ ‡ã€
     *     å¦‚æœæ ˆä¸ä¸ºç©ºï¼Œå½“å‰å³æ‹¬å·çš„ä¸‹æ ‡å‡å»æ ˆé¡¶å…ƒç´ å³ä¸ºã€Œä»¥è¯¥å³æ‹¬å·ä¸ºç»“å°¾çš„æœ€é•¿æœ‰æ•ˆæ‹¬å·çš„é•¿åº¦ã€
     *
     * éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€å¼€å§‹æ ˆä¸ºç©ºï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºå·¦æ‹¬å·çš„æ—¶å€™æˆ‘ä»¬ä¼šå°†å…¶æ”¾å…¥æ ˆä¸­ï¼Œè¿™æ ·å°±ä¸æ»¡è¶³æåŠçš„
     * ã€Œæœ€åä¸€ä¸ªæ²¡æœ‰è¢«åŒ¹é…çš„å³æ‹¬å·çš„ä¸‹æ ‡ã€ï¼Œä¸ºäº†ä¿æŒç»Ÿä¸€ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å¾€æ ˆä¸­æ”¾å…¥ä¸€ä¸ªå€¼ä¸º -1 çš„å…ƒç´ ã€‚
     */
    public int longestValidParentheses_v2(String s) {
        // æ‹¬å·åŒ¹é…çš„æ ˆä¸­åªæ”¾ '(', æ²¡æœ‰å…¶ä»–å…ƒç´ , æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾ç´¢å¼•
        Stack<Integer> stack = new Stack<>();
        stack.push(-1);
        int ret = 0;

        for (int i = 0; i < s.length(); i++) {
            char ch = s.charAt(i);
            if (ch == '(') {
                stack.push(i);
            } else {
                stack.pop();
                if (stack.isEmpty()) {
                    // å› ä¸ºæœ€å…ˆæ”¾è¿›äº†ä¸€ä¸ªä¸å¯èƒ½åŒ¹é…çš„ -1, æ‰€ä»¥å¦‚æœ stack ä¸ºç©º, æ ˆåº•ä¸ºæœ€åä¸€ä¸ªå¤±é…çš„å³æ‹¬å·
                    stack.push(i);
                } else {
                    ret = Math.max(ret, i - stack.peek());
                }
            }
        }
        return ret;
    }

    /**
     * æ—¶é—´å¤æ‚åº¦ä¸º O(n), ç©ºé—´å¤æ‚åº¦ä¸º O(n) çš„è§£æ³•
     * çº¯æ ˆè§£æ³•ï¼Œç•™å­˜
     * ç©ºé—´å¤æ‚åº¦ O(1) çš„è§£æ³•ç¨å¾®å‚è€ƒ 22, 921, 1541
     *
     * è¾…åŠ©æ ˆ + è¾…åŠ©æ•°ç»„çš„è§£æ³•
     * æœ‰æ•ˆæ‹¬å·å­—ä¸²ä¸€å®šæ˜¯å¯ä»¥å…¨éƒ¨æŠµæ¶ˆçš„
     * è®¾ç½®ä¸€ä¸ªåŒ s é•¿åº¦çš„å­—ç¬¦æ•°ç»„, æœªæŠµæ¶ˆçš„å€¼ä¸º 0, æŠµæ¶ˆå€¼ä¸º 1
     *
     * æœ€é•¿æœ‰æ•ˆæ‹¬å·å­—ä¸²å°±æ˜¯æœ€é•¿è¿ç»­ 0 çš„ä¸ªæ•°
     */
    public int longestValidParentheses(String s) {
        char[] signMap = new char[s.length()];
        // æ‹¬å·åŒ¹é…çš„æ ˆä¸­åªæ”¾ '(', æ²¡æœ‰å…¶ä»–å…ƒç´ , æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ”¾ç´¢å¼•
        Stack<Integer> stack = new Stack<>();

        for (int i = 0; i < s.length(); i++) {
            char ch = s.charAt(i);
            if (ch == '(') {
                stack.push(i);
            } else if (!stack.isEmpty()) {
                signMap[stack.pop()] = 1;
                signMap[i] = 1;
            } // stack ä¸ºç©º, å¼€å§‹ä¸‹ä¸€è½®æ‹¬å·åŒ¹é…äº†
        }

        int ret = 0;
        for (int i = 0; i < signMap.length; i++) {
            int count = 0;
            while (i < signMap.length && signMap[i] == 1) {
                i++;
                count++;
            }
            ret = Math.max(ret, count);
        }
        return ret;
    }
}
//leetcode submit region end(Prohibit modification and deletion)
