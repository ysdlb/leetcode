//ç»™å®š N ä¸ªæ— é™å®¹é‡ä¸”åˆå§‹å‡ç©ºçš„æ°´ç¼¸ï¼Œæ¯ä¸ªæ°´ç¼¸é…æœ‰ä¸€ä¸ªæ°´æ¡¶ç”¨æ¥æ‰“æ°´ï¼Œç¬¬ `i` ä¸ªæ°´ç¼¸é…å¤‡çš„æ°´æ¡¶å®¹é‡è®°ä½œ `bucket[i]`ã€‚å°æ‰£æœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š
//- å‡çº§æ°´æ¡¶ï¼šé€‰æ‹©ä»»æ„ä¸€ä¸ªæ°´æ¡¶ï¼Œä½¿å…¶å®¹é‡å¢åŠ ä¸º `bucket[i]+1`
//- è“„æ°´ï¼šå°†å…¨éƒ¨æ°´æ¡¶æ¥æ»¡æ°´ï¼Œå€’å…¥å„è‡ªå¯¹åº”çš„æ°´ç¼¸
//
//æ¯ä¸ªæ°´ç¼¸å¯¹åº”æœ€ä½è“„æ°´é‡è®°ä½œ `vat[i]`ï¼Œè¿”å›å°æ‰£è‡³å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œå¯ä»¥å®Œæˆæ‰€æœ‰æ°´ç¼¸è“„æ°´è¦æ±‚ã€‚
//
//æ³¨æ„ï¼šå®é™…è“„æ°´é‡ **è¾¾åˆ°æˆ–è¶…è¿‡** æœ€ä½è“„æ°´é‡ï¼Œå³å®Œæˆè“„æ°´è¦æ±‚ã€‚
//
//**ç¤ºä¾‹ 1ï¼š**
//
//> è¾“å…¥ï¼š`bucket = [1,3], vat = [6,8]`
//>
//> è¾“å‡ºï¼š`4`
//>
//> è§£é‡Šï¼š
//> ç¬¬ 1 æ¬¡æ“ä½œå‡çº§ bucket[0]ï¼›
//> ç¬¬ 2 ~ 4 æ¬¡æ“ä½œå‡é€‰æ‹©è“„æ°´ï¼Œå³å¯å®Œæˆè“„æ°´è¦æ±‚ã€‚
//> ![vat1.gif](https://pic.leetcode-cn.com/1616122992-RkDxoL-vat1.gif)
//
//**ç¤ºä¾‹ 2ï¼š**
//
//> è¾“å…¥ï¼š`bucket = [9,0,1], vat = [0,2,2]`
//>
//> è¾“å‡ºï¼š`3`
//>
//> è§£é‡Šï¼š
//> ç¬¬ 1 æ¬¡æ“ä½œå‡é€‰æ‹©å‡çº§ bucket[1]
//> ç¬¬ 2~3 æ¬¡æ“ä½œé€‰æ‹©è“„æ°´ï¼Œå³å¯å®Œæˆè“„æ°´è¦æ±‚ã€‚
//
//**æç¤ºï¼š**
//- `1 <= bucket.length == vat.length <= 100`
//- `0 <= bucket[i], vat[i] <= 10^4`
//
// Related Topics è´ªå¿ƒ æ•°ç»„ å †ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ï¼‰ ğŸ‘ 164 ğŸ‘ 0


import java.util.Arrays;
import java.util.Comparator;
import java.util.PriorityQueue;

//leetcode submit region begin(Prohibit modification and deletion)
class SolutionLCP33 {
    /* LCP 33.è“„æ°´: https://leetcode.cn/problems/o8SXZn/
     *
     * å¯¹äºæ¯ä¸ªæ°´æ¡¶çš„å®¹é‡ a å’Œæ°´ç¼¸çš„è“„æ°´è¦æ±‚ b
     * è‡³å°‘éœ€è¦ (b+(a-1))/a æ¬¡æ“ä½œæ‰å¯ä»¥å®Œæˆè¦æ±‚, æ•°å­¦ä¸Šéœ€è¦ b/a æ¬¡
     *
     * æˆ‘ä»¬å¯ä»¥é€‰æ‹©å‡çº§ x æ¬¡æ°´æ¡¶, æ­¤æ—¶éœ€è¦ f(x) = x + b/(a+x) æ¬¡
     * f(x) å…ˆé™ä½åå¢å¤§, æ±‚æ¯ä¸€å¯¹ a,b æ‰€éœ€çš„æœ€å°æ¬¡æ•°; ç„¶åæ‰¾å‡ºå…¨å±€çš„æœ€å¤§å€¼
     *
     * æˆ–è®¸ç‰¹æ®Šæ‰¾äºŒåˆ†æ—¶é—´å¤æ‚åº¦æ›´ä½, ä½†å®ƒå¤ªéš¾å†™äº†
     *
     * å¾ˆå®¹æ˜“å‡ºé”™çš„å‡ ä¸ªç‚¹:
     *  1. val[i] ä¸º 0, æ°´ç¼¸éœ€æ±‚ä¸º 0, ä¸éœ€è¦è€ƒè™‘æ¡¶çš„å®¹é‡
     *  2. å€’æ°´çš„æ¬¡æ•°æ±‚æœ€å¤§å€¼, ä½†å¢åŠ çš„æ¡¶çš„å®¹é‡æ¬¡æ•°æ˜¯ç´¯è®¡çš„
     * end Wrong
     *
     * ä¸Šé¢æ€è·¯é”™äº†:
     * å…¶å®æ˜¯ä¸€ä¸ªæœ¨æ¡¶ï¼ŒçŸ­æ¿éœ€è¦çš„æ¬¡æ•°æœ€å¤šï¼Œæˆ‘ä»¬æ¯æ¬¡è€ƒè™‘æ˜¯å¦å‡çº§çŸ­æ¿ï¼Œæœ€ç»ˆä½¿å€’æ°´æ¬¡æ•°+å‡çº§æ¬¡æ•°æœ€å°‘
     * è¿™ä¸ªè¶‹åŠ¿å¹¶ä¸æ˜¯å…ˆä¸‹é™åœ¨ä¸Šå‡ï¼Œæ‰€ä»¥å°±å…ˆå°è¯• 1000 æ¬¡
     */
    public int storeWater(int[] bucket, int[] vat) {
        // <need, index>
        PriorityQueue<int[]> maxHeap = new PriorityQueue<>(Comparator.<int[]>comparingInt(e -> {
            // ç¼“å­˜æ¯”è¾ƒå€¼
            if (e[0] != -1) return e[0];
            e[0] = need(bucket[e[1]], vat[e[1]]);
            return e[0];
        }).reversed());

        for (int i = 0; i < bucket.length; i++)
            maxHeap.offer(new int[]{-1, i});
        int min = Integer.MAX_VALUE;
        // æ ¹æœ¬ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™æ˜¯æœ€å°å€¼
        // æšä¸¾æ‰€æœ‰çš„è“„æ°´æ¬¡æ•°, æ¯æ¬¡å¢åŠ çŸ­æ¿çš„è“„æ°´æ¬¡æ•°
        for (int x = 0, pre; x < min;) {
            int[] bad = maxHeap.poll();
            int index = bad[1];
            pre = (bad[0] == -1) ?  this.need(bucket[index], vat[index]) : bad[0];
            min = Math.min(min, pre+x);

            bucket[index]++;
            x++;
            maxHeap.offer(new int[]{-1, index});
        }
        return min;
    }

    private int need(int a, int b) {
        if (b == 0) return 0;
        if (a == 0) return Integer.MAX_VALUE/2;
        return (b+a-1)/a;
    }

    public int storeWaterWrong(int[] bucket, int[] vat) {
        int sum = 0;
        int max = 0;
        int minus = 0;
        for (int i = 0; i < bucket.length; i++) {
            int x = 0;
            int a = bucket[i], b = vat[i];
            if (b == 0) continue;

            if (a == 0) {
                a++;
                x++;
            }
            int pre = (b+a-1)/a + x;
            int now;
            while ((now = (b+a)/(a+1)+x+1) <= pre && now > max) {
                pre = now;
                a++;
                x++;
            }

            if (pre > max) {
                max = pre;
                minus = x;
            }
            sum += x;
        }
        return max + sum - minus;
    }

    public static void main(String[] args) {
        SolutionLCP33 so = new SolutionLCP33();
        int[] buckets = new int[]{9988,5017,5130,2445,9896,9151,3625,7801,608,3283,1386,979,5209,4182,8234,9870,8714,6435,3800,956,4006,5620,7474,1205,6993,3320,1201,7593,905,3816,4522,4560,8027,8219,6686,3779,2141,1240,6504,6612,6921,7329,8145,5745,7652,4340,7933,6246,5157,9447,107,9665,3653,2978,9832,4945,4312,2199,449,8432,3230,8163,800,6547,1110,1194,9384,632,3275,1229,7230,8643,7613,8256,5043,1288,3088,8997,4554,4755,7433,8146,9722,3469,8863,5831,7816,5058,4316,7946,8402,975,2450,4958,9811,9336,21,9309,8999,56};
        int[] val = new int[]{9991,6973,7192,9876,9910,9549,3700,8814,1308,9981,9234,7292,7732,8458,8441,9939,9621,7285,7452,2718,6589,7555,8788,3202,7832,4781,8798,9299,2112,9963,8755,7240,9217,8587,6782,9703,8954,3759,6907,7218,7333,8020,8323,5750,9510,8571,8664,8510,9363,9741,8643,9825,4227,8530,9961,8511,8949,7486,9086,9690,5316,9581,9314,8817,7234,8998,9485,5394,7365,1501,7984,9802,9778,8314,7482,7117,5117,9609,8732,9728,9330,8800,9775,6210,8966,7700,8802,7607,8950,9730,9855,1231,5228,5329,9982,9532,3230,9951,9034,8299};
        int i = so.storeWater(buckets, val);
        System.out.println(i);
    }
}
//leetcode submit region end(Prohibit modification and deletion)
